<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RTC-Snap! interface</title>
    <link type="text/css" rel="stylesheet" href="css/menu.css">
    <script type="text/javascript" src="/jquery-3.0.0.min.js"></script>
    <script type="text/javascript">
       $(function(){
         $("#menu li").hover(function(){
            $("ul", this).show();
         },
         function(){
            $("ul",this).hide();
         });
        });
    </script>
    <script type="text/javascript" src="/snap/rtc_ws.js"></script>

    <script type="text/javascript">
        var rtc = new RtcWs();
        var max_lines = 25;

        function init() {
          $("[data-name='message']").keypress(press);
          rtc.open('rpc');
          rtc.waitOpened(rtc);

          show_msg('Connect to server');
        }

        /* key input event handler */
        function press(event) {
          if (event && event.which == 13) {
            var message = $("[data-name='message']").val();
            proc_press(message);
            $("[data-name='message']").val("");
          }
        }

        function proc_press(message) {
          show_msg(message);
          eval(message);
          //rtc.send(message);
        }

        /** dispay message **/
        function show_msg(message) {
          var msgs = $("[data-name='disp']").find("div");
          while (msgs.length >= max_lines) {
            msgs = msgs.last().remove();
          }
          var msgtag = $("<div>").text(message);
          $("[data-name='disp']").prepend(msgtag);
          return message;
        }

        /** call initialize **/
        $(init);
          
    </script>
</head>
<body>
  <div class="menubar">
    <ul id ="menu">
      <li><a href="#">Main</a>
        <ul class="sub">
          <li><a href="projects.html" target="project">Open Project List</a></li>
          <li><a href="#">Exit Server</a></li>
        </ul>
      </li>
      <li><a href="#">Edit</a>
        <ul class="sub">
          <li><a href="#">Config...</a></li>
        </ul>
      </li>
      <li><a href="#">Tool</a>
        <ul class="sub">
          <li><a href="#">RTC Builder</a></li>
          <li><a href="#">Snap!</a></li>
        </ul>
      </li>
      <li><a href="#">Help</a>
        <ul class="sub">
          <li><a href="#">About...</a></li>
        </ul>
      </li>
    </ul>
  </div>
  <div style="padding-top:10px;">
    Command:<input type="text" data-name="message" size="20" />
    <hr />
    <div data-name="disp" ></div>

  </div>
 <p />
  <div id="footer">&nbsp;Copyright(C) 2016 Isao Hara, All Rights Reversed</div>

</body>
</html>
